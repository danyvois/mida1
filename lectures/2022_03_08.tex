%!TEX root = ../main.tex
\section{Non-zero mean ARMA processes}\label{sec:non-zero-mean-arma}
Consider now $y(t)$ ARMA process generated as the steady-state output of a linear operator $W(z)$ that receive as input $e(t)$, where $e(t) \sim \WN(\mu, \lambda^{2})$, with $\mu\neq0$.

\begin{thm}[Gain theorem]\label{thm:gain-theorem}
	The steady-state output is constant and it holds that:
	\[
		\E[y(t)]=m_{y}=W(z)|_{z=1} \cdot \mu
	\]
\end{thm}

Indeed:
\begin{align*}
		\E[y(t)] &=\E\left[a_{1} y(t-1)+\cdots+a_{m} y(t-m)+c_{0} e(t)+\cdots+c_{n} e(t-n)\right] \\
		&=a_{1} \E[y(t-1)]+\cdots+a_{m} \E[y(t-m)]+c_{0} \E[e(t)]+\cdots+c_{n} \E[e(t-n)]
\end{align*}
$$
m_{y}=a_{1} m_{y}+\cdots+a_{m} m_{y}+c_{0} \cdot \mu+\cdots+c_{n} \cdot \mu
$$
i.e.
\[
	m_{y}=\frac{c_{0}+c_{1}+\cdots+c_{n}}{1-a_{1}-\cdots-a_{m}} \cdot \mu=W(1) \cdot \mu.
\]
For any $t$, we define two new \textbf{unbiased processes}:
$$
\boxed{
	\begin{cases}
		\tilde{y}(t)=y(t)-m_{y}\\
		\tilde{e}(t)=e(t)-m_{e}
	\end{cases}
}
$$
such that their mean is zero. Moreover we have that:
\begin{align*}
	\tilde{y}(t)&= y(t)-m_{y}\\
	&= a_{1} y(t-1)+\cdots+a_{m} y(t-m)+c_{0} e(t)+\cdots+c_{n} e(t-n)-m_{y} \\
	&= a_{1}\left(\tilde{y}(t-1)+m_{y}\right)+\cdots+a_{m }\left(\tilde{y}(t-m)+m_{y}\right)+\\
	&\qquad +c_{0}\left(\tilde{e}(t)+m_{e}\right)+\cdots+c_{n}\left(\tilde{e}(t-n)+m_{e}\right)-m_{y} \\
	&= a_{1} \tilde{y}(t-1)+\cdots+a_{m} \tilde{y}(t-m)+c_{0} \tilde{e}(t)+\cdots+c_{n} \tilde{e}(t-n) \\
	&\qquad \underbrace{-\left(1-a_{1}-\cdots-a_{m}\right) m_{y}+\left(c_{0}+\cdots + c_{n}\right) m_{e}}_{=0\text { since } m_{y}=\frac{c_{0}+c_{1}+\cdots+c_{n}}{1-a_{1}-\cdots-a_{m }} m_{e}=W(1) \cdot \mu} \\
	&=a_{1} \tilde{y}(t-1)+\cdots+a_{m} \tilde{y}(t-m)+c_{0} \tilde{e}(t)+\cdots+c_{n} \tilde{e}(t-n)
\end{align*}
where $\tilde{e}(t)\sim \WN(0, \lambda^{2})$, hence this is a standard zero mean ARMA process. $\tilde{y}(t)$ is the steady-state solution to $W(z)=\frac{A(z)}{C(z)}$ \emph{with the same transfer function} fed by $\tilde{e}(t)$.
\[
	\boxed{y(t)=W(z)e(t) \iff \tilde{y}(t)=W(z)\tilde{e}(t)}
\]

In addition, the \emph{covariance function is also the same}:
$$
	\boxed{\gamma_{y}(\tau)=\E\left[\left(y(t)-m_{y}\right) \cdot\left(y(t-\tau)-m_{y}\right)\right]=\E[(\tilde{y}(t)) \cdot(\tilde{y}(t-\tau))]=\gamma_{\tilde{y}}(\tau)}
$$

We can see this method graphically. Thanks to linearity, this picture:

\begin{figure}[htpb]
	\centering
	\begin{tikzpicture}
		% place nodes
		\node [sum] (sum) at (0,0){};
		\node [block,right=2cm of sum] (w) {$W(z)$};

		% connect nodes
		\draw[stealth-] (sum.north) -- ++(0, 1)
			node[midway, left]{$\mu$}
			node[very near start, right] {$+$};

		\draw[stealth-] (sum.south) -- ++(0,-1)
			node[midway, left]{$\tilde e(t)$}
			node[very near start, right] {$+$};

		\draw[-stealth] (sum.east) -- (w.west) node[midway, above] {$e(t)$};
		\draw[-stealth] (w.east) -- ++(2,0) node[midway, above] {$y(t)$};
	\end{tikzpicture}
\end{figure}
\FloatBarrier
is equivalent to the following:
\begin{figure}[htpb]
	\centering
	\begin{tikzpicture}
		% place nodes
		\node [sum] (sum) at (0,0){};
		\node [block,above left=0.5cm and 2cm of sum] (wm) {$W(z)$};
		\node [block,below left=0.5cm and 2cm of sum] (we) {$W(z)$};

		% connect nodes
		\draw[stealth-] (wm.west) -- ++(-2,0) node[midway, above]{$\mu$};
		\draw[stealth-] (we.west) -- ++(-2,0) node[midway, above]{$\tilde e(t)$};

		\draw[-stealth] (wm.east) -| (sum.north)
			node[near start,above] {$m_y$}
			node[very near end, right] {$+$};
		\draw[-stealth] (we.east) -| (sum.south)
			node[near start,above] {$\tilde y(t)$}
			node[very near end, right] {$+$};

		\draw[-stealth] (sum.east) -- ++(2,0) node[midway, above] {$y(t)$};
	\end{tikzpicture}
\end{figure}
\FloatBarrier

\section{ARMAX (and ARX) processes}

\begin{defn}
	Let $e(t) \sim \WN(0, \lambda^{2})$. An \textbf{ARMAX process} of order $m,p,n,k$ is a process generated by a \gls{wn} $e(t)$ and by an \textbf{eXogenous} deterministic input $u(t)$, according to:
	\begin{equation*}
	   \boxed{
		   \begin{aligned}
				y(t)&=a_{1} y(t-1)+a_{2} y(t-2)+\cdots+a_{m} y(t-m) &\text{AR($m$) part}\\
				&\qquad+c_{0} e(t)+c_{1} e(t-1)+\cdots+c_{n} e(t-n) &\text{MA($n$) part} \\
				&\qquad+b_{0} u(t-d)+b_{1} u(t-d-1)+\cdots+b_{p} u(t-d-p)  &\text{X($d,p$) part}
			\end{aligned}
		}
	\end{equation*}
\end{defn}

ARMAX($m,p,n,d$) denotes an ARMAX process of orders $m,p,n$ with delay between the input $u(t)$ and output $y(t)$ equal to $d$.

ARX($m,p,d$) equals to ARMAX($m,p,0,d$).

Then:
\begin{gather*}
	y(t) = \frac{(b_{0}+b_{1} z^{-1}+\cdots+b_{p} z^{-p}) z^{-d}}{(1-a_{1} z^{-1}-a_{2} z^{-2}-\cdots-a_{m} z^{-m})} u(t)
	+ \frac{(c_{0}+c_{1} z^{-1}+\cdots+c_{n} z^{-n})}{(1-a_{1} z^{-1}-a_{2} z^{-2}-\cdots-a_{m} z^{-m})} e(t) \\
	\boxed{
		y(t) =
		\underbrace{\frac{B(z) z^{-d}}{A(z)} u(t)}_{\text{deterministic}}
		+\underbrace{\frac{C(z)}{A(z)} e(t)}_{\substack{\text{stochastic}\\ \text{(ARMA)}}}
	}
\end{gather*}
where:
\begin{gather*}
	\boxed{B(z) = \left(b_{0}+b_{1} z^{-1}+\cdots+b_{p} z^{-p}\right)}\\
	\boxed{C(z) = \left(c_{0}+c_{1} z^{-1}+\cdots+c_{n} z^{-n}\right)}\\
	\boxed{A(z) = \left(1-a_{1} z^{-1}-a_{2} z^{-2}-\cdots-a_{m} z^{-m}\right)}
\end{gather*}

Both $\frac{B(z) z^{-d}}{A(z)}$ and $\frac{C(z)}{A(z)}$ are transfer functions.

In the ARX process $C(z)=1$.

\chapter{Analysis in the Frequency Domain}
\begin{defn}
	The \textbf{spectral density} or \textbf{spectrum} of a \gls{ssp} $y(t)$ is defined as:
	\[
		\Gamma_{y}(\omega)=\sum_{\tau=-\infty}^{+\infty} \gamma_{y}(\tau) e^{-j \omega \tau} \qquad \omega \in \RR
	\]
\end{defn}

In other words, $\Gamma_y(\omega)$ is defined as the discrete Fourier transform of the covariance function.

\textbf{Properties of $\Gamma_{y}(\omega)$:}
\begin{enumerate}
	\item is a \textbf{real} function of the real variable $\omega$,
	$$
		\Im\left(\Gamma_{y}(\omega)\right)=0 \quad \forall \omega \in \RR
	$$
	\item is a \textbf{positive} function,
	$$
		\Gamma_{y}(\omega) \geq 0 \quad \forall \omega \in \RR
	$$
	\item is an \textbf{even} function,
	$$
		\Gamma_{y}(\omega)=\Gamma_{y}(-\omega) \quad \forall \omega \in \RR
	$$
	\item is \textbf{$2\pi$-periodic}:
	$$
		\Gamma_{y}(\omega)=\Gamma_{y}(\omega+k \cdot 2 \pi) \quad \forall \omega \in \RR, \forall k \in \mathbb{Z}
	$$
\end{enumerate}

\begin{rem}
As a consequence of 3. and 4., we will plot the spectral density in $[0, \pi]$.
\end{rem}

\begin{exa}[Density of a \gls{wn}]
	Let us consider $e(t) \sim \WN(\mu, \lambda^{2})$.

	Covariance function:
	\[
		\gamma_{e}(\tau) =
		\begin{cases}
			\lambda^{2}, & \text { if } \tau=0, \\
			0, & \text { if } \tau \neq 0.
		\end{cases}
	\]
	Spectral density:
	\[
		\Gamma_{e}(\omega) =\sum_{\tau=-\infty}^{+\infty} \gamma_{e}(\tau) e^{-j \omega \tau}=\underbrace{\gamma_{e}(0)}_{=\lambda^2} \underbrace{e^{-j \omega 0}}_{=1}+\underbrace{\gamma_{e}(1)}_{=0} e^{-j \omega} + \underbrace{\gamma_{e}(-1)}_{=0} e^{j \omega}+\cdots = \lambda^{2}
	\]
	\gls{wn} have constant and equal to $\lambda^{2}$ spectral density.
\end{exa}

\begin{exa}
Let us consider the generic MA($1$) process defined by $y(t)=e(t)+c \cdot e(t-1)$, with $c \in \RR$, $e(t)\sim \WN(0,1)$.\\
We know that:
\begin{align*}
	&\gamma_{y}(0)=(1^{2}+c^{2})\cdot \lambda^{2}=(1+c^{2})\\
	&\gamma_{y}(1)=(1 \cdot c) \cdot \lambda^{2}=c \\
	&\gamma_{y}(\tau)=0, \text{ otherwise.}
\end{align*}
Spectral density:
\begin{align*}
	\Gamma_{y}(\omega)&=\sum_{\tau=-\infty}^{+\infty} \gamma_{y}(\tau) e^{-j \omega \tau}\\
	&=\gamma_{y}(0)+\gamma_{y}(1)(e^{-j \omega})+\gamma_{y}(-1)(e^{+j \omega}) \\
	&=1+c^{2}+c(e^{-j \omega}+e^{j \omega})
\end{align*}

Remembering Euler's representation of the exponential:
$$
	e^{-j \omega}+e^{j \omega}=\cos (\omega)-j \sin (\omega)+\cos (\omega)+j \sin (\omega)=2 \cos (\omega),
$$
we have:
$$
	\Gamma_y(\omega)=1+c^{2}+2 c \cdot \cos (\omega).
$$
which is real, non-negative, even and $2 \pi$-periodic.
\end{exa}
Let the process $y(t)$ be the steady-state output of an asymptotically stable digital filter fed by an \gls{ssp}, i.e. $y(t)=F(z) v(t)$. Then, the following formula for the spectral density of $y(t)$ holds:
\[
	\boxed{\Gamma_{y}(\omega)=|F(e^{j \omega})|^{2} \cdot \Gamma_{v}(\omega)}
\]
If the input $v(t)$ is a \gls{wn} with variance $\lambda^{2}$, then:
$$
\Gamma_{y}(\omega)=|F(e^{j \omega})|^{2} \lambda^{2}
$$

Let us consider again the generic MA($1$) process defined by $y(t)=e(t)+c \cdot e(t-1)$, with $c \in \RR$, $e(t)\sim \WN(0,\lambda^2)$, this time with $\lambda^2 \neq 1$.\\
Then:
\begin{align*}
	y(t)=\left(1+c z^{-1}\right) e(t) \implies \Gamma_{y}(\omega)&=\left|1+c e^{-j \omega}\right|^{2} \cdot \lambda^{2}\\
	&=\left|1+c \cos (\omega)-j c\sin (\omega)\right|^{2}\cdot\lambda^2\\
	&=[\left(1+c \cos (\omega)\right)^2+\left(-c\sin (\omega)\right)^2]\cdot\lambda^2\\
	&=[1+c^{2}+2 c \cos (\omega)]\cdot\lambda^2
\end{align*}
See Figure \ref{fig:example-density} for the plot of the spectral density.

Moreover:
\begin{align*}
	|1+c e^{-j \omega}|^2&=\left(1+c e^{-j \omega}\right)\left(1+c e^{+j \omega}\right)\\
	&=\underbrace{\left(1+c z^{-1}\right)}_\text{where $z=e^{j \omega}$}\underbrace{\left(1+c z^{-1}\right)}_\text{where $z=e^{-j \omega}$}
\end{align*}
\begin{align*}
	W(z)=\frac{C(z)}{A(z)}=\frac{(1+q_1z^{-1})\cdots(1+q_nz^{-1})}{(1+p_1z^{-1})\cdots(1+p_mz^{-1})}
\end{align*}
where $q_i$ are the zeros and $p_i$ the poles.
\begin{align*}
	\left|W\left(e^{j \omega}\right)\right|^{2}&=\frac{|1+q_1e^{-j \omega}|^2\cdots|1+q_ne^{-j \omega}|^2}{|1+p_1e^{-j \omega}|^2\cdots|1+p_me^{-j \omega}|^2}\\
	&=\frac{(1+q_1e^{-j \omega})\cdots(1+q_ne^{-j \omega})}{(1+p_1e^{-j \omega})\cdots(1+p_me^{-j \omega})}\cdot\frac{(1+q_1e^{j \omega})\cdots(1+q_ne^{j \omega})}{(1+p_1e^{j \omega})\cdots(1+p_me^{j \omega})}\\
			&=W\left(e^{j \omega}\right)\cdot W\left(e^{-j \omega}\right)
\end{align*}

\begin{figure}[htpb]
	\centering
	\begin{tikzpicture}
	    
	    %\draw[very thin,color=gray] (-3.14,-1) grid (3.14,3);
	    \draw[-stealth, name path=xax] (-4, 0) -- (4, 0) node (ynode) [below right] {$\omega$};
	    \draw[-stealth, name path=yax] ( 0, 0) -- (0, 3) node (xnode) [above left] {$\Gamma_y(\omega)$};
	    % \x r means to convert ’\x’ from degrees to _r_adians:
	    \draw[name path=cpos, domain=-pi:pi, smooth, variable=\x, black, thick] plot ({\x}, {1+0.5*0.5+2*0.5*cos(\x r)}) node[right]{$c>0$};
	    \draw[name path=cneg, domain=-pi:pi, smooth, variable=\x, black, dashed, thick] plot ({\x}, {1+0.5*0.5-2*0.5*cos(\x r)}) node[right]{$c<0$};
	    
	    \draw[-] (-pi,0.1)--(-pi,-0.1) node[below] {$-\pi$};
	    \draw[-] ( pi,0.1)--( pi,-0.1) node[below] {$ \pi$};
	    \draw[-] ( 0 ,0.1)--( 0, -0.1) node[below] {$ 0  $};
	    
	    \draw [name intersections={of=cpos and yax, by=x}, fill] (x)
	        circle [radius=2pt]
	        node[above right] {$(1+c^2)$};


	    \draw [name intersections={of=cneg and yax, by=x}, fill] (x)
	        node[fill=white,below right,xshift=2pt,yshift=-2pt] {$(1-c^2)$}
	        circle [radius=2pt];

	\end{tikzpicture}
	\caption{Spectral density for MA($1$) process.}
	\label{fig:example-density}
\end{figure}